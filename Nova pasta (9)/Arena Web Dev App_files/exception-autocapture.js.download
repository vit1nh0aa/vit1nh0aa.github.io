!function(){"use strict";var r="undefined"!=typeof window?window:void 0,e="undefined"!=typeof globalThis?globalThis:r;"undefined"==typeof self&&(e.self=e),"undefined"==typeof File&&(e.File=function(){});var n=null==e?void 0:e.navigator;null==e||e.document,null==e||e.location,null==e||e.fetch,null!=e&&e.XMLHttpRequest&&"withCredentials"in new e.XMLHttpRequest&&e.XMLHttpRequest,null==e||e.AbortController,null==n||n.userAgent;var t=null!=r?r:{};function i(r,e,n,t,i,a,o){try{var u=r[a](o),c=u.value}catch(r){return void n(r)}u.done?e(c):Promise.resolve(c).then(t,i)}function a(r){return function(){var e=this,n=arguments;return new Promise((function(t,a){var o=r.apply(e,n);function u(r){i(o,t,a,u,c,"next",r)}function c(r){i(o,t,a,u,c,"throw",r)}u(void 0)}))}}function o(){return o=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var t in n)({}).hasOwnProperty.call(n,t)&&(r[t]=n[t])}return r},o.apply(null,arguments)}var u=Array.isArray,c=Object.prototype.toString,s=u||function(r){return"[object Array]"===c.call(r)},l=r=>void 0===r,v=r=>"[object String]"==c.call(r);function f(r){return null===r||"object"!=typeof r}function d(r,e){return Object.prototype.toString.call(r)==="[object "+e+"]"}function h(r){return!l(Event)&&function(r,e){try{return r instanceof e}catch(r){return!1}}(r,Event)}var p,y,w;function g(r){var e=globalThis._posthogChunkIds;if(e){var n=Object.keys(e);return w&&n.length===y?w:(y=n.length,w=n.reduce(((n,t)=>{p||(p={});var i=p[t];if(i)n[i[0]]=i[1];else for(var a=r(t),o=a.length-1;o>=0;o--){var u=a[o],c=null==u?void 0:u.filename,s=e[t];if(c&&s){n[c]=s,p[t]=[c,s];break}}return n}),{}))}}class b{constructor(r,e,n){void 0===n&&(n=[]),this.coercers=r,this.stackParser=e,this.modifiers=n}buildFromUnknown(r,e){void 0===e&&(e={});var n=e&&e.mechanism||{handled:!0,type:"generic"},t=this.buildCoercingContext(n,e,0).apply(r),i=this.buildParsingContext(e),a=this.parseStacktrace(t,i);return{$exception_list:this.convertToExceptionList(a,n),$exception_level:"error"}}modifyFrames(r){var e=this;return a((function*(){for(var n of r)n.stacktrace&&n.stacktrace.frames&&s(n.stacktrace.frames)&&(n.stacktrace.frames=yield e.applyModifiers(n.stacktrace.frames));return r}))()}coerceFallback(r){var e;return{type:"Error",value:"Unknown error",stack:null==(e=r.syntheticException)?void 0:e.stack,synthetic:!0}}parseStacktrace(r,e){var n,t;return null!=r.cause&&(n=this.parseStacktrace(r.cause,e)),""!=r.stack&&null!=r.stack&&(t=this.applyChunkIds(this.stackParser(r.stack,r.synthetic?e.skipFirstLines:0),e.chunkIdMap)),o({},r,{cause:n,stack:t})}applyChunkIds(r,e){return r.map((r=>(r.filename&&e&&(r.chunk_id=e[r.filename]),r)))}applyCoercers(r,e){for(var n of this.coercers)if(n.match(r))return n.coerce(r,e);return this.coerceFallback(e)}applyModifiers(r){var e=this;return a((function*(){var n=r;for(var t of e.modifiers)n=yield t(n);return n}))()}convertToExceptionList(r,e){var n,t,i,a={type:r.type,value:r.value,mechanism:{type:null!==(n=e.type)&&void 0!==n?n:"generic",handled:null===(t=e.handled)||void 0===t||t,synthetic:null!==(i=r.synthetic)&&void 0!==i&&i}};r.stack&&(a.stacktrace={type:"raw",frames:r.stack});var u=[a];return null!=r.cause&&u.push(...this.convertToExceptionList(r.cause,o({},e,{handled:!0}))),u}buildParsingContext(r){var e;return{chunkIdMap:g(this.stackParser),skipFirstLines:null!==(e=r.skipFirstLines)&&void 0!==e?e:1}}buildCoercingContext(r,e,n){void 0===n&&(n=0);var t=(n,t)=>{if(t<=4){var i=this.buildCoercingContext(r,e,t);return this.applyCoercers(n,i)}};return o({},e,{syntheticException:0==n?e.syntheticException:void 0,mechanism:r,apply:r=>t(r,n),next:r=>t(r,n+1)})}}var m="?";function E(r,e,n,t,i){var a={platform:r,filename:e,function:"<anonymous>"===n?m:n,in_app:!0};return l(t)||(a.lineno=t),l(i)||(a.colno=i),a}var j=(r,e)=>{var n=-1!==r.indexOf("safari-extension"),t=-1!==r.indexOf("safari-web-extension");return n||t?[-1!==r.indexOf("@")?r.split("@")[0]:m,n?"safari-extension:"+e:"safari-web-extension:"+e]:[r,e]},k=/^\s*at (\S+?)(?::(\d+))(?::(\d+))\s*$/i,x=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,O=/\((\S*)(?::(\d+))(?::(\d+))\)/,S=(r,e)=>{var n=k.exec(r);if(n){var[,t,i,a]=n;return E(e,t,m,+i,+a)}var o=x.exec(r);if(o){if(o[2]&&0===o[2].indexOf("eval")){var u=O.exec(o[2]);u&&(o[2]=u[1],o[3]=u[2],o[4]=u[3])}var[c,s]=j(o[1]||m,o[2]);return E(e,s,c,o[3]?+o[3]:void 0,o[4]?+o[4]:void 0)}},A=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,M=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,P=(r,e)=>{var n=A.exec(r);if(n){if(n[3]&&n[3].indexOf(" > eval")>-1){var t=M.exec(n[3]);t&&(n[1]=n[1]||"eval",n[3]=t[1],n[4]=t[2],n[5]="")}var i=n[3],a=n[1]||m;return[a,i]=j(a,i),E(e,i,a,n[4]?+n[4]:void 0,n[5]?+n[5]:void 0)}},R=/\(error: (.*)\)/,_=50;function C(){return function(r){for(var e=arguments.length,n=new Array(e>1?e-1:0),t=1;t<e;t++)n[t-1]=arguments[t];return function(e,t){void 0===t&&(t=0);for(var i=[],a=e.split("\n"),u=t;u<a.length;u++){var c=a[u];if(!(c.length>1024)){var s=R.test(c)?c.replace(R,"$1"):c;if(!s.match(/\S*Error: /)){for(var l of n){var v=l(s,r);if(v){i.push(v);break}}if(i.length>=_)break}}}return function(r){if(!r.length)return[];var e=Array.from(r);return e.reverse(),e.slice(0,_).map((r=>{return o({},r,{filename:r.filename||(n=e,n[n.length-1]||{}).filename,function:r.function||m});var n}))}(i)}}("web:javascript",S,P)}class D{match(r){return this.isDOMException(r)||this.isDOMError(r)}coerce(r,e){var n=v(r.stack);return{type:this.getType(r),value:this.getValue(r),stack:n?r.stack:void 0,cause:r.cause?e.next(r.cause):void 0,synthetic:!1}}getType(r){return this.isDOMError(r)?"DOMError":"DOMException"}getValue(r){var e=r.name||(this.isDOMError(r)?"DOMError":"DOMException");return r.message?e+": "+r.message:e}isDOMException(r){return d(r,"DOMException")}isDOMError(r){return d(r,"DOMError")}}class T{match(r){return r instanceof Error}coerce(r,e){return{type:this.getType(r),value:this.getMessage(r,e),stack:this.getStack(r),cause:r.cause?e.next(r.cause):void 0,synthetic:!1}}getType(r){return r.name||r.constructor.name}getMessage(r,e){var n=r.message;return n.error&&"string"==typeof n.error.message?String(n.error.message):String(n)}getStack(r){return r.stacktrace||r.stack||void 0}}class U{constructor(){}match(r){return d(r,"ErrorEvent")&&null!=r.error}coerce(r,e){var n,t=e.apply(r.error);return t||{type:"ErrorEvent",value:r.message,stack:null==(n=e.syntheticException)?void 0:n.stack,synthetic:!0}}}var F=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/i;class I{match(r){return"string"==typeof r}coerce(r,e){var n,[t,i]=this.getInfos(r);return{type:null!=t?t:"Error",value:null!=i?i:r,stack:null==(n=e.syntheticException)?void 0:n.stack,synthetic:!0}}getInfos(r){var e="Error",n=r,t=r.match(F);return t&&(e=t[1],n=t[2]),[e,n]}}var L=["fatal","error","warning","log","info","debug"];function z(r,e){void 0===e&&(e=40);var n=Object.keys(r);if(n.sort(),!n.length)return"[object has no keys]";for(var t=n.length;t>0;t--){var i=n.slice(0,t).join(", ");if(!(i.length>e))return t===n.length||i.length<=e?i:i.slice(0,e)+"..."}return""}class H{match(r){return"object"==typeof r&&null!==r}coerce(r,e){var n,t=this.getErrorPropertyFromObject(r);return t?e.apply(t):{type:this.getType(r),value:this.getValue(r),stack:null==(n=e.syntheticException)?void 0:n.stack,level:this.isSeverityLevel(r.level)?r.level:"error",synthetic:!0}}getType(r){return h(r)?r.constructor.name:"Error"}getValue(r){if("name"in r&&"string"==typeof r.name){var e="'"+r.name+"' captured as exception";return"message"in r&&"string"==typeof r.message&&(e+=" with message: '"+r.message+"'"),e}if("message"in r&&"string"==typeof r.message)return r.message;var n=this.getObjectClassName(r);return(n&&"Object"!==n?"'"+n+"'":"Object")+" captured as exception with keys: "+z(r)}isSeverityLevel(r){return v(r)&&!(r=>v(r)&&0===r.trim().length)(r)&&L.indexOf(r)>=0}getErrorPropertyFromObject(r){for(var e in r)if(Object.prototype.hasOwnProperty.call(r,e)){var n=r[e];if(n instanceof Error)return n}}getObjectClassName(r){try{var e=Object.getPrototypeOf(r);return e?e.constructor.name:void 0}catch(r){return}}}class N{match(r){return h(r)}coerce(r,e){var n,t=r.constructor.name;return{type:t,value:t+" captured as exception with keys: "+z(r),stack:null==(n=e.syntheticException)?void 0:n.stack,synthetic:!0}}}class V{match(r){return f(r)}coerce(r,e){var n;return{type:"Error",value:"Primitive value captured as exception: "+String(r),stack:null==(n=e.syntheticException)?void 0:n.stack,synthetic:!0}}}class W{match(r){return d(r,"PromiseRejectionEvent")}coerce(r,e){var n,t=this.getUnhandledRejectionReason(r);return f(t)?{type:"UnhandledRejection",value:"Non-Error promise rejection captured with value: "+String(t),stack:null==(n=e.syntheticException)?void 0:n.stack,synthetic:!0}:e.apply(t)}getUnhandledRejectionReason(r){if(f(r))return r;try{if("reason"in r)return r.reason;if("detail"in r&&"reason"in r.detail)return r.detail.reason}catch(r){}return r}}var Y=function(e,n){var{debugEnabled:i}=void 0===n?{}:n,a={t:function(n){if(r&&(t.POSTHOG_DEBUG||i)&&!l(r.console)&&r.console){for(var a=("__rrweb_original__"in r.console[n]?r.console[n].__rrweb_original__:r.console[n]),o=arguments.length,u=new Array(o>1?o-1:0),c=1;c<o;c++)u[c-1]=arguments[c];a(e,...u)}},info:function(){for(var r=arguments.length,e=new Array(r),n=0;n<r;n++)e[n]=arguments[n];a.t("log",...e)},warn:function(){for(var r=arguments.length,e=new Array(r),n=0;n<r;n++)e[n]=arguments[n];a.t("warn",...e)},error:function(){for(var r=arguments.length,e=new Array(r),n=0;n<r;n++)e[n]=arguments[n];a.t("error",...e)},critical:function(){for(var r=arguments.length,n=new Array(r),t=0;t<r;t++)n[t]=arguments[t];console.error(e,...n)},uninitializedWarning:r=>{a.error("You must initialize PostHog before calling "+r)},createLogger:(r,n)=>Y(e+" "+r,n)};return a},q=Y("[PostHog.js]").createLogger;null!=n&&n.sendBeacon,q("[Error tracking]");var B=q("[ExceptionAutocapture]"),G=new b([new D,new W,new U,new T,new N,new H,new I,new V],C()),J={wrapOnError:e=>{var n=r;n||B.info("window not available, cannot wrap onerror");var t=n.onerror;return n.onerror=function(){for(var r,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];var o=i[4],u=i[0],c=G.buildFromUnknown(o||u,{mechanism:{handled:!1}});return e(c),null!==(r=null==t?void 0:t(...i))&&void 0!==r&&r},n.onerror.__POSTHOG_INSTRUMENTED__=!0,()=>{var r;null==(r=n.onerror)||delete r.__POSTHOG_INSTRUMENTED__,n.onerror=t}},wrapUnhandledRejection:e=>{var n=r;n||B.info("window not available, cannot wrap onUnhandledRejection");var t=n.onunhandledrejection;return n.onunhandledrejection=function(r){var i,a=G.buildFromUnknown(r,{mechanism:{handled:!1}});return e(a),null!==(i=null==t?void 0:t.apply(n,[r]))&&void 0!==i&&i},n.onunhandledrejection.__POSTHOG_INSTRUMENTED__=!0,()=>{var r;null==(r=n.onunhandledrejection)||delete r.__POSTHOG_INSTRUMENTED__,n.onunhandledrejection=t}},wrapConsoleError:r=>{var e=console;e||B.info("console not available, cannot wrap console.error");var n=e.error;return e.error=function(){for(var e,t=arguments.length,i=new Array(t),a=0;a<t;a++)i[a]=arguments[a];e=1==i.length?i[0]:i.join(" ");var o=i.find((r=>r instanceof Error)),u=G.buildFromUnknown(o||e,{mechanism:{handled:!1},syntheticException:new Error("PostHog syntheticException"),skipFirstLines:2});return r(u),null==n?void 0:n(...i)},e.error.__POSTHOG_INSTRUMENTED__=!0,()=>{var r;null==(r=e.error)||delete r.__POSTHOG_INSTRUMENTED__,e.error=n}}};t.__PosthogExtensions__=t.__PosthogExtensions__||{},t.__PosthogExtensions__.errorWrappingFunctions=J,t.posthogErrorWrappingFunctions=J}();
//# sourceMappingURL=exception-autocapture.js.map
